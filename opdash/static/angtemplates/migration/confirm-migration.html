<div class="migration-mgr rs-container" ng-style="vm.isRacker == true ? {'margin-top':'30px'} : {'margin-top':'0px'}">
    <rssaveprogress stepname="ConfirmMigration" type="link" ng-class="{disabled:vm.migrating}"></rssaveprogress>
    <br><br>
    <div class="rs-main rs-panel">
        <div class="rs-content rs-panel" ng-class="{disabled:vm.migrating}">
            <rsnavigationpanel pagenum="2"></rsnavigationpanel>
            <hr>
            <div class="rs-inner">
                <rstenantfawsdetails editmigration="true"></rstenantfawsdetails>
                <div class="rs-row">
                    <div class="span-12">
                        <h3>Review configurations and schedule your migration</h3>
                    </div>
                </div>
                <div class="clear"></div>
                <div class="rs-row">
                    <div class="span-6">
                        <rsselecteditemspanel showrec="true"></rsselecteditemspanel>
                    </div>
                    <div class="span-3">
                        <div class="plain-panel" style="min-height:240px;">
                            <a ng-link="['MigrationRecommendation']" class=" rs-btn-action rs-pull-right">
                                <i class="rs-edit" title="Modify this"></i>
                            </a>
                            <h3>Projected Cost <a href="" role="button" data-trigger="hover" data-placement="top" data-toggle="popover"
                                    data-content="The projected pricing consist of infrastructure costs only, and support costs are not included in the provided price."><sup><i class="fa fa-info-circle rs-quiet"></i></sup></a></h3>
                            <hr>
                            <p>
                                <big><b>{{vm.cost | currency: '$'}}</b>/month </big>
                                <br>
                                <a href role="button" data-toggle="modal" ng-click="vm.openUsageCostsModal()"><small>See Details</small></a>
                            </p>
                            <hr class="dash">
                            <big><b>Support Level</b> </big>
                            <p>
                                Navigator <sup>&#174; <i class="fa fa-info-circle rs-quiet" role="button" data-trigger="hover"
                                    data-placement="top" data-toggle="popover" data-content="<b>Navigator Monthly Service Fee starts at $400</b>. We can act as a business associate to support customers with HIPAA workloads on AWS. Personal contact to assist with onboarding. A combined set of AWS and Rackspace recommendations from certified AWS architects"></i></sup>
                                <br>
                                <small>* Navigator cost not reflected here.</small>
                                <br>
                                <!--<small>Legal <a data-html="true"  data-placement="top" data-toggle="popover" data-content="<b>Please note that we may place a $1 authorization hold to confirm your account.</b> <br>
                                <small>(Our lawyers make us say this)</small>
                                <br> Your use of Rackspace websites is subject to the <a href='http://www.rackspace.com/information/legal/websiteterms?_ga=1.254955403.24213883.1488833556' target='_blank'>Website Terms</a>." ><i class="fa fa-info-circle rs-quiet"></i></a>
                                </small>-->
                            </p>
                        </div>
                    </div>
                    <rsschedulemigration></rsschedulemigration>
                </div>
                <br>
                <div class="rs-pull-right">
                    <div class="faws-legal-txt">
                        <input id="accept_terms" name="accept_terms" type="checkbox" ng-model="vm.acceptTermsAndConditions" required="" class="ng-pristine ng-untouched ng-invalid ng-invalid-required">                        <span class="ng-binding"> I acknowledge that I have read and accept the <a href="https://www.rackspace.com/information/legal/GSA" target="_blank">Rackspace Global Services Agreement</a> and the <a href="http://www.rackspace.com/information/legal/awssupport" target="_blank">Fanatical Support for AWS Terms and Conditions</a>.</span>
                    </div>
                    <a class="rs-btn " ng-link="['MigrationRecommendation']">Back</a>
                    <rssaveprogress stepname="ConfirmMigration" type="button" class="ng-isolate-scope"></rssaveprogress>
                    <button class="rs-btn rs-btn-primary " type="submit" ng-hide="vm.migrating" ng-click="vm.disableButton($event);vm.checkStatus()" ng-disabled="(!vm.scheduleMigration || !vm.acceptTermsAndConditions || !vm.emptyEquipments)  ">Confirm & Schedule</button>
                    <a class="rs-btn disabled" disabled="disabled" ng-show="vm.migrating">Scheduling...</a>
                    <i class="rs-processing-indicator" ng-show="vm.migrating"></i>
                </div>
                <div class="clear"></div>

                <!--<div style="margin-top: 10px; text-align: right;" ng-show="vm.migrating" >Preparing and sending migration request...<i class="fa fa-refresh fa-spin" style="font-size:16px"></i></div>-->
                <div style="color: red; text-align: right;" ng-show="vm.errorInMigration">Error while trying to migrate</div>
                <br>
            </div>
        </div>
    </div>
    <rsinteractivefooter></rsinteractivefooter>

    <!-- modals -->
    <!-- confrm migration modal -->
    <div id="confirm-migration-modal" class="modal modal-warning hide animated fadeIn" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <h3>You have chosen this time for your migration.</h3>
        </div>
        <div class="modal-body">
            <h3>{{vm.schedule.date}} </h3>
            <p>Is this correct?</p>
            <div class="rs-control-group">
                <a ng-click="vm.migrate()" ng-show="!vm.migrating" class="rs-btn rs-btn-primary">Yes, Continue</a>
                <a class="rs-btn" data-dismiss="modal" aria-hidden="true">No, Go back</a>
            </div>
        </div>
        <div class="modal-footer">
        </div>
    </div>
    <!-- duplicate-instance modal -->
    <div id="duplicate-instance" class="modal modal-warning hide animated fadeIn" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <h3>Cannot continue !</h3>
        </div>
        <div class="modal-body">
            <p>
                <div>One or more resources in your selection have already been scheduled / migrated in another batch.</div>
                <div>Please go to step1 to re-select resources.</div>
            </p>
        </div>
        <div class="modal-footer">
            <a ng-click="vm.goToStep1()" class="rs-btn rs-btn-primary">Go to Step-1</a>
            <a class="rs-btn" data-dismiss="modal" aria-hidden="true" ng-click="vm.migrating = false">No, Go back</a>
        </div>
    </div>
    <!-- modify migration modal -->
    <div id="modify-modal" class="modal modal-warning hide animated fadeIn" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <h3> Uh oh! That didn't work </h3>
        </div>
        <div class="modal-body">
            <p>{{vm.message}}</p>
        </div>
        <div class="modal-footer">
            <a class="rs-btn" data-dismiss="modal" aria-hidden="true">Close</a>
        </div>
    </div>
    <!-- confrm migration modal faws modal-->
    <div id="confirm-migration-modalFAWS" class="modal modal-warning modal-success hide animated fadeIn" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <h3>Confirm your Migration &amp; FAWS account. </h3>
        </div>
        <div class="modal-body">
            <!-- <div class="rs-row">
                 <div class="span-5">
                    <img src="images/FAWS-logo.jpg" alt="FAWS logo" class="FAWS-logo">
                </div> 
                <div class="span-7">
                    <br>
                    <h3>Confirm your Migration &amp; FAWS account. </h3>
                </div><br>
            </div>-->
            <div class="rs-row">
                <div class="span-2">
                    <i class="fa fa-calendar fa-4x fa-fw"></i>
                </div>
                <div class="span-10">
                    <big><b>Migration initiated for:</b><br>
                    {{vm.schedule.date}}</big>
                </div>
            </div>

            <br>
            <hr>
            <big>We are creating a new FAWS account for you, <br> what would you like to name it?</big>
            <br>
            <br>
            <input type="text" class="rs-input-xlarge" placeholder="FAWS AccountName" />
            <br>
            <b>Please note that we may place a $1 authorization hold to confirm your account.</b> <br>
            <small>(Our lawyers make us say this)</small>
            <br> Your use of Rackspace websites is subject to the <a href='http://www.rackspace.com/information/legal/websiteterms?_ga=1.254955403.24213883.1488833556'
                target='_blank'>Website Terms</a>.</small>
        </div>
        <div class="modal-footer">
            <a ng-click="vm.migrate()" ng-show="!vm.migrating" class="rs-btn rs-btn-primary">Submit &amp; Continue </a>
            <a class="rs-btn" data-dismiss="modal" aria-hidden="true">Cancel</a>
        </div>
    </div>
    <!-- end modals -->
    <!-- modals -->
    <!-- calculator_modal -->
    <div id="calculator_modal" class="modal modal-warning hide animated fadeIn details" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-header">
            <br>
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="fa fa-times"></i></button>
            <h3 class="rs-page-title" style="color : #333">Pricing Calculations</h3>
        </div>
    <div class="modal-body">
        <big><b>Current Costs - Rackspace</b></big>
        <br>
        <br>
        <table class="rs-list-table">
            <thead>
                <tr>
                    <th>Resource</th>
                    <th>Uptime Cost (Hrs)</th>
                    <th>Bandwidth Out Cost (Used)</th>
                    <th>Rackspace Storage (GB)</th>
                    <th>Total Cost</th>
                </tr>
            </thead>
            <tbody>
                <tr class="" ng-repeat="item in vm.costCalculationItems">
                    <td class="rs-table-text">{{item.resourceName}}</td>
                    <td class="rs-table-text" ng-if="item.rax_uptime_cost !== 'NA'">${{item.rax_uptime_cost + " (" + item.rax_uptime + ")"}}</td>
                    <td class="rs-table-text" ng-if="item.rax_uptime_cost === 'NA'">New Server</td>
                    <td class="rs-table-text" ng-if="item.rax_bandwidth_cost !== 'NA'">${{item.rax_bandwidth_cost + " (" + item.rax_bandwidth + " GB)"}}</td>
                    <td class="rs-table-text" ng-if="item.rax_bandwidth_cost === 'NA'">New Server</td>
                    <td class="rs-table-text">{{item.storage}}</td>
                    <td class="rs-table-text" ng-if="item.rax_total_cost !== undefined">${{item.rax_total_cost}}</td>
                    <td class="rs-table-text" ng-if="item.rax_total_cost === undefined">New Server</td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td style="text-align:right;"><b>Grand Total = </b></td>
                    <td style="text-align:left;" ng-show="!vm.isNaN(vm.totalOfCostCalculationItems)"><b>${{vm.totalOfCostCalculationItems.toFixed(2)}}<b></td>
                    <td style="text-align:left;" ng-show="vm.isNaN(vm.totalOfCostCalculationItems)"><b>---<b></td>
                </tr>
            </tbody>
        </table>
        <br>
        <big><b>Projected Costs - AWS (excludes FAWS support)</b></big>
        <br>
        <br>
        <table class="rs-list-table">
            <thead>
                <tr>
                    <th>Resource</th>
                    <th>Uptime Cost (Hrs)</th>
                    <th>Bandwidth Out Cost (Used)</th>
                    <th>AWS Storage Cost (GB)</th>
                    <th>Total Cost</th>
                </tr>
            </thead>
            <tbody>
                <tr class="pricing" ng-repeat="item in vm.projectedCostCalculationItems">
                    <td class="rs-table-text" ng-if="item.aws_bandwidth !== 'NA'">{{item.resourceName}}</td>
                    <td class="rs-table-text" ng-if="item.aws_bandwidth === 'NA'"><span style="color: red;"><b>*</b></span>{{item.calculated_cost_resourcename}}</td>
                    <td class="rs-table-text">${{item.aws_uptime_cost + " (" + item.rax_uptime + ")"}}</td>
                    <td class="rs-table-text" ng-if="item.aws_bandwidth !== 'NA'">${{item.aws_bandwidth_cost + " (" + item.rax_bandwidth + " GB)"}}</td>
                    <td class="rs-table-text" ng-if="item.aws_bandwidth === 'NA'">N/A</td>
                    <td class="rs-table-text">${{item.storage_rate + " (" + item.rax_storage + ")"}}</td>
                    <td class="rs-table-text">${{item.aws_total_cost}}</td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td style="text-align:right;"><b>Grand Total = </b></td>
                    <td style="text-align:left;">${{vm.totalOfProjectedCostCalculationItems.toFixed(2)}}</td>
                </tr>
            </tbody>
        </table>
        <p ng-if="vm.showCalculatedCostDialog === true" style="text-align: left;"><span style="color: red;"><b>*</b></span><b>This is a calculated cost assuming an uptime of 24 hrs. and 30 days</b></p>
    </div>
    </div>

    <!-- end modals -->
    <script>
        $(document).ready(function () {
            $('[data-toggle="popover"]').popover({
                html: true
            });
        });
    </script>
    </script>

    <!-- accordion icon behavior -->
    <script type="text/javascript">
        $(document).ready(function () {
            $(".accordion-heading + .collapse:not(.in)").prev().append("<i class='fa fa-chevron-down'></i>");
            $(".accordion-heading + .collapse.in").prev().append("<i class='fa fa-chevron-up'></i>");
            $('.accordion-heading a').click(function () {
                $('.plain-panel').find('.collapse.in').prev().find("i").removeClass("fa-chevron-up").addClass("fa-chevron-down");
                $(this).parents('.accordion-heading').find("i.fa-chevron-down").removeClass("fa-chevron-down").addClass("fa-chevron-up");
                $(this).parents('.plain-panel').find('.collapse.in').prev().find("i.fa-chevron-up").removeClass("fa-chevron-up").addClass("fa-chevron-down");
            });
        });
    </script>
